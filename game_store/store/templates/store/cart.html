{% extends 'store/base.html' %}

{% block title %}–ö–æ—Ä–∑–∏–Ω–∞ - Game Store{% endblock %}

{% block content %}
<h1>–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞</h1>

{% if cart_items %}
<div style="overflow-x: auto;">
    <table style="width: 100%; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
        <thead>
            <tr style="background: #667eea; color: white;">
                <th style="padding: 15px; text-align: left;">–ò–≥—Ä–∞</th>
                <th style="padding: 15px; text-align: center;">–¶–µ–Ω–∞</th>
                <th style="padding: 15px; text-align: center;">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                <th style="padding: 15px; text-align: center;">–ò—Ç–æ–≥–æ</th>
                <th style="padding: 15px; text-align: center;">–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
        </thead>
        <tbody>
            {% for item in cart_items %}
            <tr style="border-bottom: 1px solid #f0f0f0;">
                <td style="padding: 15px;">
                    <div style="display: flex; align-items: center;">
                        {% if item.game.image %}
                        <img src="{{ item.game.image.url }}" alt="{{ item.game.title }}" style="width: 50px; height: 50px; object-fit: cover; border-radius: 4px; margin-right: 15px;">
                        {% else %}
                        <div style="width: 50px; height: 50px; background: #667eea; border-radius: 4px; margin-right: 15px; display: flex; align-items: center; justify-content: center; color: white;">
                            üéÆ
                        </div>
                        {% endif %}
                        <div>
                            <strong>{{ item.game.title }}</strong><br>
                            <small>{{ item.game.genre.name }}</small>
                        </div>
                    </div>
                </td>
                <td style="padding: 15px; text-align: center;">{{ item.game.price }} ‚ÇΩ</td>
                <td style="padding: 15px; text-align: center;">
                    <form action="{% url 'update_cart_item' item.game.id %}" method="post" style="display: inline-block;">
                        {% csrf_token %}
                        <input type="number" name="quantity" value="{{ item.quantity }}" min="1" max="{{ item.game.quantity }}" 
                               style="width: 60px; padding: 5px; text-align: center;">
                        <button type="submit" class="btn" style="padding: 5px 10px; font-size: 0.9rem;">–û–±–Ω–æ–≤–∏—Ç—å</button>
                    </form>
                </td>
                <td style="padding: 15px; text-align: center; font-weight: bold;">{{ item.total }} ‚ÇΩ</td>
                <td style="padding: 15px; text-align: center;">
                    <form action="{% url 'remove_from_cart' item.game.id %}" method="post" style="display: inline;">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger" style="padding: 5px 10px; font-size: 0.9rem;">–£–¥–∞–ª–∏—Ç—å</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr style="background: #f8f9fa;">
                <td colspan="3" style="padding: 15px; text-align: right;"><strong>–û–±—â–∞—è —Å—É–º–º–∞:</strong></td>
                <td colspan="2" style="padding: 15px; text-align: center; font-size: 1.2rem; color: #667eea;">
                    <strong>{{ total_price }} ‚ÇΩ</strong>
                </td>
            </tr>
        </tfoot>
    </table>
</div>

<div style="margin-top: 30px; display: flex; justify-content: space-between;">
    <a href="{% url 'game_list' %}" class="btn">‚Üê –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏</a>
    
    {% if user.is_authenticated %}
    <a href="{% url 'checkout' %}" class="btn" style="background: #28a745;">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑ ‚Üí</a>
    {% else %}
    <a href="{% url 'admin:login' %}?next={% url 'checkout' %}" class="btn" style="background: #ffc107;">–í–æ–π—Ç–∏ –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è</a>
    {% endif %}
</div>
{% else %}
<div style="text-align: center; padding: 60px; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
    <p style="font-size: 1.5rem; margin-bottom: 20px;">–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>
    <p style="margin-bottom: 30px;">–î–æ–±–∞–≤—å—Ç–µ –∏–≥—Ä—ã –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞</p>
    <a href="{% url 'game_list' %}" class="btn">–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥</a>
</div>
{% endif %}
{% endblock %}